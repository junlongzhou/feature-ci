import{u as O,_ as ee,a as ae}from"./StatusChip-Dd-W5F2d.js";import{r as m,e as te,N as le,x as j,y as se,o as N,k as S,w as e,i as a,Q as o,R as C,X as ue,D as oe,n as r,l as T,q as U,Y as ne,Z as A,_ as D,M as I}from"./index-D3ojRB6d.js";import{V as b,a as h,b as re,c as E,d as ie}from"./VForm-DPioLLmB.js";import{V as de,a as $}from"./VDialog-C1QuPGpr.js";import{V as ce}from"./VDataTableServer-CUXprsMY.js";import{V as fe,e as p}from"./VToolbar-CTtrlpKH.js";import{i as d,j as B}from"./VBtn-fYltUM7Y.js";const me={class:"text-h5"},ve=["href"],be={__name:"FeatureList",setup(pe){const c=m(!1),f=m(!1),R=m([{title:"Feature ID",align:"start",key:"id",sortable:!0},{title:"Name",key:"name"},{title:"Status",key:"status",align:"center"},{title:"Owner",key:"last_update_author"},{title:"Updated",key:"last_update_date"},{title:"Actions",key:"actions",sortable:!1}]),n=m(-1),z=te(()=>n.value===-1?"New Feature":"Edit Feature"),v=m(!1),{features:i,currentFeature:u,defaultFeature:_,user:w,pageNumber:V,pageSize:k,total:M,alertMessage:P,alertType:q}=le(O()),{getFeatures:g,createFeature:K,updateFeature:L,deleteFeature:Q,isFeatureEditable:X}=O();function Y(s){n.value=i.value.indexOf(s),u.value=Object.assign({},s),c.value=!0}function Z(s){n.value=i.value.indexOf(s),u.value=Object.assign({},s),f.value=!0}async function G(){await Q(),i.value.splice(n.value,1),x(),v.value=!0}function y(){c.value=!1,I(()=>{u.value=Object.assign({},_.value),n.value=-1})}function x(){f.value=!1,I(()=>{u.value=Object.assign({},_.value),n.value=-1})}async function H(){u.value.properties.forEach(s=>{Array.isArray(s.value)&&(s.value=s.value.join(","))}),u.value.changes.forEach(s=>{s.properties.forEach(l=>{Array.isArray(l.value)&&(l.value=l.value.join(","))})}),n.value>-1?(await L(),Object.assign(i.value[n.value],u.value)):(await K(),i.value.push(u.value)),y(),v.value=!0}function F(s){const l=i.value.indexOf(s);return l!=-1?X(i.value[l].status):!0}return j(c,s=>{s||y()}),j(f,s=>{s||x()}),se(()=>{g(),u.value=Object.assign({},_.value),n.value=-1}),(s,l)=>{const J=ae;return N(),S(ie,{fluid:""},{default:e(()=>[a(b,{class:"elevation-2"},{default:e(()=>[a(h,null,{default:e(()=>[a(de,{type:o(q),density:"compact",theme:"dark",text:o(P),modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=t=>v.value=t),elevation:"3",closable:""},null,8,["type","text","modelValue"])]),_:1}),a(ce,{"fixed-header":"",headers:R.value,items:o(i),"sort-by":[{key:"id",order:"asc"}],"items-per-page":o(k),"onUpdate:itemsPerPage":l[4]||(l[4]=t=>C(k)?k.value=t:null),page:o(V),"onUpdate:page":l[5]||(l[5]=t=>C(V)?V.value=t:null),"items-length":o(M),"items-per-page-options":[10,15,20],"onUpdate:options":o(g)},ue({top:e(()=>[o(w).token?(N(),S(fe,{key:0,color:"white"},{default:e(()=>[a(p),a($,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=t=>c.value=t),"max-width":"900px"},{activator:e(({props:t})=>[a(d,oe({"prepend-icon":"mdi-plus",class:"mr-3"},t,{color:"primary",variant:"elevated"}),{default:e(()=>[r(" New ")]),_:2},1040)]),default:e(()=>[a(b,null,{default:e(()=>[a(h,null,{default:e(()=>[T("span",me,U(z.value),1)]),_:1}),a(re,null,{default:e(()=>[a(J,{modelValue:o(u),"onUpdate:modelValue":l[1]||(l[1]=t=>C(u)?u.value=t:null)},null,8,["modelValue"])]),_:1}),a(E,null,{default:e(()=>[a(p),a(d,{color:"primary",variant:"elevated",onClick:y},{default:e(()=>[r(" Cancel ")]),_:1}),a(d,{color:"primary",variant:"elevated",onClick:H},{default:e(()=>[r(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a($,{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=t=>f.value=t),"max-width":"500px"},{default:e(()=>[a(b,null,{default:e(()=>[a(h,{class:"text-h5"},{default:e(()=>[r("Are you sure you want to delete this item?")]),_:1}),a(E,null,{default:e(()=>[a(p),a(d,{color:"blue-darken-1",variant:"text",onClick:x},{default:e(()=>[r("Cancel")]),_:1}),a(d,{color:"blue-darken-1",variant:"text",onClick:G},{default:e(()=>[r("OK")]),_:1}),a(p)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):ne("",!0)]),"item.name":e(({item:t})=>[T("a",{href:`/features/${t.id}/`},U(t.name),9,ve)]),"item.status":e(({item:t})=>[a(ee,{status:t.status},null,8,["status"])]),"no-data":e(()=>[a(d,{color:"primary",onClick:o(g)},{default:e(()=>[r(" Reset ")]),_:1},8,["onClick"])]),_:2},[o(w).token?{name:"item.actions",fn:e(({item:t})=>[A(a(B,{class:"me-2",size:"small",onClick:W=>Y(t)},{default:e(()=>[r(" mdi-pencil ")]),_:2},1032,["onClick"]),[[D,F(t)]]),A(a(B,{size:"small",onClick:W=>Z(t)},{default:e(()=>[r(" mdi-delete ")]),_:2},1032,["onClick"]),[[D,F(t)]])]),key:"0"}:void 0]),1032,["headers","items","items-per-page","page","items-length","onUpdate:options"])]),_:1})]),_:1})}}};export{be as _};
