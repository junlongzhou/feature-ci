import{_ as le,u as j}from"./components-D9PxTpgW.js";import{i as M,j as te,V as oe,a as P}from"./VDialog-C1QuPGpr.js";import{ac as ne,N as F,y as $,o as w,k as U,w as a,i as e,Q as d,n as v,r as _,e as ue,x as q,R as B,X as se,D as ie,l as re,q as de,Y as me,M as A}from"./index-D3ojRB6d.js";import{o as pe,e as D,V as g,a as x,b as z,d as E,c as I}from"./VForm-DPioLLmB.js";import{V as ve}from"./VDataTableServer-CUXprsMY.js";import{V as ce,e as k}from"./VToolbar-CTtrlpKH.js";import{i as f,j as R}from"./VBtn-fYltUM7Y.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={__name:"ComponentForm",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(T){const t=ne(T,"modelValue"),{builds:m,pageSize:N}=F(M()),{getBuilds:p}=M();$(()=>{N.value=500,C()});async function C(){await p();const c=m.value.find(l=>l.id===t.value.build);c||(c=m.value[0]);let s=[];c.property_templates.forEach(l=>{const o=t.value.properties.find(i=>i.name===l.name);if(l.kind==="COMPONENT"){l.style.values||(l.style.values=l.values);let i="";if(o)i=o.value;else{const V=l.values.split(",");i=V?V[0]:l.values}s.push({name:l.name,value:i,style:l.style})}}),t.value.properties.slice(0),t.value.properties=s}return(c,s)=>{const l=le;return w(),U(E,null,{default:a(()=>[e(pe,null,{default:a(()=>[e(D,{modelValue:t.value.repository,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.repository=o),label:"Repository",variant:"outlined",rules:[o=>!!o||"Component repository is required"],required:""},null,8,["modelValue","rules"]),e(D,{modelValue:t.value.main_branch,"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.main_branch=o),label:"Main Branch",variant:"outlined",rules:[o=>!!o||"Component main branch is required"],required:""},null,8,["modelValue","rules"]),e(te,{label:"Build",modelValue:t.value.build,"onUpdate:modelValue":[s[2]||(s[2]=o=>t.value.build=o),C],items:d(m),"item-value":"id","item-title":"name",variant:"outlined",required:""},null,8,["modelValue","items"]),e(g,null,{default:a(()=>[e(x,null,{default:a(()=>[v(" Configuration ")]),_:1}),e(z,null,{default:a(()=>[e(l,{modelValue:t.value.properties,"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.properties=o),mode:"edit"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}},_e={class:"text-h5"},Ce={__name:"ComponentList",setup(T){const t=_(!1),m=_(!1),N=_([{title:"Id",key:"id"},{title:"Repository",key:"repository"},{title:"Main branch",key:"main_branch"},{title:"Actions",key:"actions",sortable:!1}]),p=_(-1),C=ue(()=>p.value===-1?"New Component":"Edit Component"),c=_(!1),{build:s,currentComponent:l,defaultComponent:o,components:i,user:V,pageNumber:y,pageSize:b,total:L,alertMessage:K,alertType:Q}=F(j()),{getComponents:O,createComponent:X,updateComponent:Y,deleteComponent:G}=j();function H(u){p.value=i.value.indexOf(u),l.value=Object.assign({},u),t.value=!0}function J(u){p.value=i.value.indexOf(u),l.value=Object.assign({},u),m.value=!0}async function W(){await G(),i.value.splice(p.value,1),h(),c.value=!0}function S(){t.value=!1,A(()=>{l.value=Object.assign({},o.value),p.value=-1})}function h(){m.value=!1,A(()=>{l.value=Object.assign({},o.value),p.value=-1})}async function Z(){l.value.properties.forEach(u=>{Array.isArray(u.value)&&(u.value=u.value.join(","))}),p.value>-1?(await Y(),Object.assign(i.value[p.value],l.value)):(await X(),i.value.push(l.value)),S(),c.value=!0}return q(t,u=>{u||S()}),q(m,u=>{u||h()}),$(()=>{b.value=10,y.value=1,s.value=0,O()}),(u,r)=>{const ee=Ve;return w(),U(E,{fluid:""},{default:a(()=>[e(g,{class:"elevation-2"},{default:a(()=>[e(x,null,{default:a(()=>[e(oe,{type:d(Q),density:"compact",theme:"dark",text:d(K),modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=n=>c.value=n),elevation:"3",closable:""},null,8,["type","text","modelValue"])]),_:1}),e(ve,{"fixed-header":"",headers:N.value,items:d(i),"sort-by":[{key:"id",order:"asc"}],"items-per-page":d(b),"onUpdate:itemsPerPage":r[4]||(r[4]=n=>B(b)?b.value=n:null),page:d(y),"onUpdate:page":r[5]||(r[5]=n=>B(y)?y.value=n:null),"items-length":d(L),"items-per-page-options":[10,15,20],"onUpdate:options":d(O)},se({top:a(()=>[d(V).token?(w(),U(ce,{key:0,color:"white"},{default:a(()=>[e(k),e(P,{modelValue:t.value,"onUpdate:modelValue":r[2]||(r[2]=n=>t.value=n),"max-width":"900px"},{activator:a(({props:n})=>[e(f,ie({"prepend-icon":"mdi-plus",class:"mr-3"},n,{color:"primary",variant:"elevated"}),{default:a(()=>[v(" New ")]),_:2},1040)]),default:a(()=>[e(g,null,{default:a(()=>[e(x,null,{default:a(()=>[re("span",_e,de(C.value),1)]),_:1}),e(z,null,{default:a(()=>[e(ee,{modelValue:d(l),"onUpdate:modelValue":r[1]||(r[1]=n=>B(l)?l.value=n:null)},null,8,["modelValue"])]),_:1}),e(I,null,{default:a(()=>[e(k),e(f,{color:"primary",variant:"elevated",onClick:S},{default:a(()=>[v(" Cancel ")]),_:1}),e(f,{color:"primary",variant:"elevated",onClick:Z},{default:a(()=>[v(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(P,{modelValue:m.value,"onUpdate:modelValue":r[3]||(r[3]=n=>m.value=n),"max-width":"500px"},{default:a(()=>[e(g,null,{default:a(()=>[e(x,{class:"text-h5"},{default:a(()=>[v("Are you sure you want to delete this item?")]),_:1}),e(I,null,{default:a(()=>[e(k),e(f,{color:"blue-darken-1",variant:"text",onClick:h},{default:a(()=>[v("Cancel")]),_:1}),e(f,{color:"blue-darken-1",variant:"text",onClick:W},{default:a(()=>[v("OK")]),_:1}),e(k)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):me("",!0)]),"no-data":a(()=>[e(f,{color:"primary",onClick:d(O)},{default:a(()=>[v(" Reset ")]),_:1},8,["onClick"])]),_:2},[d(V).token?{name:"item.actions",fn:a(({item:n})=>[e(R,{class:"me-2",size:"small",onClick:ae=>H(n)},{default:a(()=>[v(" mdi-pencil ")]),_:2},1032,["onClick"]),e(R,{size:"small",onClick:ae=>J(n)},{default:a(()=>[v(" mdi-delete ")]),_:2},1032,["onClick"])]),key:"0"}:void 0]),1032,["headers","items","items-per-page","page","items-length","onUpdate:options"])]),_:1})]),_:1})}}},ye={};function be(T,t){const m=Ce;return w(),U(m)}const Se=fe(ye,[["render",be]]);export{Se as default};
